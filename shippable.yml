language: node_js

node_js:
  - 0.10

build_image: shippableimages/ubuntu1404_nodejs

notifications:
     email:
         on_success: change
         on_failure: always

env:
 global:
  - secure: ABA1PZWXs21YWVliiHDhPgLbag1Dk+QQpZjxXMV3AuVAudCCp2tUH/dcKPqTZDBmSPWC3k/OdTbXjUJFLqfv3vP3U6KKZqEVWi5Bt36WSPZv48SH9cpAOtyYouLcm0hhAniU5jNhsFS7YOUjMHRaec99tvcqeYXpzvb6mcjXV1Gxj1NaH7aypd3rLuXU4LXaBJT6fWWL0YndrXzd8mw7Tq/EFNXA4h8Oa51iZW4P6Q6R+Zsi009X1w1Dd+KkwjqoPXL9PnewW6UI+GBEE8GfdVgDrsmrgzHa3oRash21aaV+CNtP6XOTqu28qMRKHtQiguSlhGT+de5k4qLGyi0mlA==
 before_install:
  - source ~/.nvm/nvm.sh && nvm install $SHIPPABLE_NODE_VERSION
  - node --version

install:
  - npm install

after_success:
  - git config user.email $GIT_EMAIL
  - git config user.name $GIT_USER
  - git config --global push.default matching
  - git checkout $BRANCH
  - echo "email=$NPM_EMAIL" > ~/.npmrc
  - echo "_auth=$NPM_AUTH_TOKEN" >> ~/.npmrc
  - npm version patch --message "auto-publish %s via SHIPPABLE [ci skip] [skip ci]"
  - git remote set-url origin ssh://git@github.com/$REPO_NAME
  - git push
  - npm publish
