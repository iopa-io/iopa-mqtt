language: node_js

node_js:
  - 0.10

build_image: shippableimages/ubuntu1404_nodejs

notifications:
     email:
         on_success: change
         on_failure: always

env:
 global:
  - secure: XO4pd86vg9YDKHfNdt+b2qIaB59/tmE3L8C/Zy4bc5oPB9LAYWtHZGtVdiqBn0gxZgErvckxg33kdzDJxjEEcU6ZeK5BvoFG0ei47+qdxBQJM7jJgZIsestGuokecSgYCHkI/leaTq/tYR0caxNOC0cmpJLFLrJfF1M4ysJaTJC5f93jPLwnxtgkv6459WZLr2WExGAWzA1eki7n/+4C1O7dOazyUtKcheYuCzrmRvVD8r1PYPuZb3fVxgK2kwlMA3p6lPrZkuDXKeWVmbitNO/SgAYOqyyDgOE2KFgZPg1IcdiQU7Er9DSLN0BtcJioUxtaf3492jlAfNTTa4eIow==
 before_install:
  - source ~/.nvm/nvm.sh && nvm install $SHIPPABLE_NODE_VERSION
  - node --version

install:
  - npm install

after_success:
  - git config user.email $GIT_EMAIL
  - git config user.name $GIT_USER
  - git config --global push.default matching
  - git checkout $BRANCH
  - echo "email=$NPM_EMAIL" > ~/.npmrc
  - echo "_auth=$NPM_AUTH_TOKEN" >> ~/.npmrc
  - npm version patch --message "auto-publish %s via SHIPPABLE [ci skip] [skip ci]"
  - git remote set-url origin ssh://git@github.com/$REPO_NAME
  - git push
  - npm publish
